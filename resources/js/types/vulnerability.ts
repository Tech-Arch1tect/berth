export type VulnerabilitySeverity =
  | 'Critical'
  | 'High'
  | 'Medium'
  | 'Low'
  | 'Negligible'
  | 'Unknown';

export type ScanStatus = 'pending' | 'running' | 'completed' | 'failed' | 'timeout';

export interface ImageVulnerability {
  id: number;
  scan_id: number;
  image_name: string;
  vulnerability_id: string;
  severity: VulnerabilitySeverity;
  package: string;
  installed_version: string;
  fixed_version?: string;
  description?: string;
  data_source?: string;
  cvss?: number;
  created_at: string;
  updated_at: string;
}

export interface ImageScan {
  id: number;
  server_id: number;
  stack_name: string;
  agent_scan_id: string;
  status: ScanStatus;
  total_images: number;
  scanned_images: number;
  started_at: string;
  completed_at?: string;
  error_message?: string;
  last_polled_at?: string;
  poll_failures: number;
  last_poll_error?: string;
  vulnerabilities?: ImageVulnerability[];
  created_at: string;
  updated_at: string;
}

export interface VulnerabilitySummary {
  critical: number;
  high: number;
  medium: number;
  low: number;
  negligible: number;
  unknown: number;
  total: number;
}

export interface LatestScanResponse {
  scan: ImageScan;
  summary: VulnerabilitySummary;
}

export interface ScanWithSummary {
  scan: ImageScan;
  summary?: VulnerabilitySummary;
}

export interface ScansHistoryResponse {
  scans: ScanWithSummary[];
}

export interface ScanComparison {
  base_scan: ImageScan;
  compare_scan: ImageScan;
  new_vulnerabilities: ImageVulnerability[];
  fixed_vulnerabilities: ImageVulnerability[];
  unchanged_count: number;
}

export interface ScanTrendPoint {
  scan_id: number;
  date: string;
  summary: VulnerabilitySummary;
}

export interface ScanTrendResponse {
  trend: ScanTrendPoint[];
}
