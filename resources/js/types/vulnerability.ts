export type {
  ImageScan,
  ImageVulnerability,
  VulnerabilitySummary,
  ScanWithSummary,
  ScanComparison,
  ScanTrendPoint,
  PerImageTrend,
  ScanScope,
} from '../api/generated/models';

export type VulnerabilitySeverity =
  | 'Critical'
  | 'High'
  | 'Medium'
  | 'Low'
  | 'Negligible'
  | 'Unknown';

export type ScanStatus = 'pending' | 'running' | 'completed' | 'failed' | 'timeout';

export interface GrypeMatch {
  vulnerability: GrypeVulnerability;
  relatedVulnerabilities?: GrypeVulnerability[];
  matchDetails?: GrypeMatchDetail[];
  artifact: GrypeArtifact;
}

export interface GrypeVulnerability {
  id: string;
  dataSource: string;
  namespace?: string;
  severity: string;
  urls?: string[];
  description?: string;
  cvss?: GrypeCVSS[];
  fix: GrypeFix;
}

export interface GrypeCVSS {
  source?: string;
  type?: string;
  version?: string;
  vector?: string;
  metrics: GrypeCVSSMetrics;
}

export interface GrypeCVSSMetrics {
  baseScore: number;
  exploitabilityScore?: number;
  impactScore?: number;
}

export interface GrypeFix {
  versions?: string[];
  state?: string;
}

export interface GrypeMatchDetail {
  type?: string;
  matcher?: string;
}

export interface GrypeArtifact {
  id?: string;
  name: string;
  version: string;
  type?: string;
  locations?: GrypeLocation[];
  language?: string;
  licenses?: string[];
  cpes?: string[];
  purl?: string;
}

export interface GrypeLocation {
  path?: string;
  layerId?: string;
}
