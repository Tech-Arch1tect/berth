FROM golang:1.25-alpine

RUN apk add --no-cache \
    git \
    curl \
    nodejs \
    npm \
    gcc \
    musl-dev

RUN go install github.com/air-verse/air@latest

ENV PATH="/root/go/bin:${PATH}"

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY package.json package-lock.json ./
RUN npm ci

CMD ["/bin/sh", "-c", "npm run dev & air -c .air.toml"]
