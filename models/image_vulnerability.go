package models

const (
	VulnSeverityCritical   = "Critical"
	VulnSeverityHigh       = "High"
	VulnSeverityMedium     = "Medium"
	VulnSeverityLow        = "Low"
	VulnSeverityNegligible = "Negligible"
	VulnSeverityUnknown    = "Unknown"
)

type ImageVulnerability struct {
	BaseModel
	ScanID           uint    `json:"scan_id" gorm:"not null;index"`
	ImageName        string  `json:"image_name" gorm:"not null;index"`
	VulnerabilityID  string  `json:"vulnerability_id" gorm:"not null;index"`
	Severity         string  `json:"severity" gorm:"not null;index"`
	Package          string  `json:"package" gorm:"not null"`
	InstalledVersion string  `json:"installed_version"`
	FixedVersion     string  `json:"fixed_version,omitempty"`
	Description      string  `json:"description,omitempty" gorm:"type:text"`
	DataSource       string  `json:"data_source,omitempty"`
	CVSS             float64 `json:"cvss,omitempty"`

	Scan ImageScan `json:"-" gorm:"foreignKey:ScanID"`
}

func (ImageVulnerability) TableName() string {
	return "image_vulnerabilities"
}
